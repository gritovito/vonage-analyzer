{% extends "base.html" %}

{% block title %}{{ cluster.name }} - Response Scripts Library{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<nav class="breadcrumb">
    <a href="{{ url_for('index') }}">Home</a>
    <span class="separator">/</span>
    <a href="{{ url_for('clusters') }}">Categories</a>
    <span class="separator">/</span>
    <span class="current">{{ cluster.name }}</span>
</nav>

<!-- Cluster Header -->
<div class="cluster-header" style="border-left-color: {{ cluster.color }}">
    <div class="cluster-icon-large" style="background-color: {{ cluster.color }}20; color: {{ cluster.color }}">
        {{ cluster.icon }}
    </div>
    <div class="cluster-header-info">
        <h1>{{ cluster.name }}</h1>
        <p class="cluster-description">{{ cluster.description }}</p>
        <div class="cluster-header-stats">
            <span class="stat"><strong>{{ cluster.question_count }}</strong> questions</span>
            <span class="stat"><strong>{{ cluster.resolved_count or 0 }}</strong> resolved</span>
        </div>
    </div>
</div>

<!-- Subcategories -->
<div class="section">
    <h2>Subcategories</h2>

    {% if cluster.subcategories %}
    <div class="subcategories-grid">
        {% for sub in cluster.subcategories %}
        <div class="subcategory-card">
            <div class="subcategory-header">
                <a href="{{ url_for('subcategory_detail', subcategory_id=sub.id) }}" class="subcategory-name">
                    {{ sub.name }}
                </a>
                <span class="subcategory-count">{{ sub.question_count }} questions</span>
            </div>

            {% if sub.top_questions %}
            <div class="top-questions">
                {% for q in sub.top_questions %}
                <a href="{{ url_for('question_detail', question_id=q.id) }}" class="top-question">
                    <span class="question-text">{{ q.canonical_text|truncate_text(45) }}</span>
                    <span class="times-asked">{{ q.times_asked }}x</span>
                </a>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-questions">No questions yet</p>
            {% endif %}

            <a href="{{ url_for('subcategory_detail', subcategory_id=sub.id) }}" class="view-all-link">
                View all questions
            </a>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="empty-state">No subcategories defined for this cluster.</p>
    {% endif %}
</div>
{% endblock %}
